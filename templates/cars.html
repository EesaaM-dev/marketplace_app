{% extends "base.html" %}

{% block title %}Cars{% endblock %}
{% block content%}


<style>


.custom-table  {
    margin-top: 15px;  
    padding-right:50px;
    background-color:#343a40;
    color: #ffffff;
}

.custom-table th, .custom-table td{
    border:2px solid rgb(0, 0, 0);
    padding: 0.8em;
    height: 65px;
    vertical-align: middle;
}

.custom-table thead th {
    vertical-align: middle;
}
.custom-table tbody tr:hover{
    color: #e0db51;
}

.id-row {
    width: 100px;
}



.action-row{
    width:220px;
    margin-right: 50px;
}

.custom-row{
    width:200px;
}

.btn-group button,.btn-group button:hover  {
    margin-right: 5px;
    border:1px solid rgb(0, 0, 0);
    font-size: 16px;
}
</style>
{% if error %}
    <div class="alert alert-danger" role="alert" ><strong>Error:</strong> {{ error }}
    </div>
    {% endif %}
{% if car_list %}
<div class="table-responsive container-fluid table-container">
<table class="table table-bordered custom-table table-hover">
        <tr>
            <thead>
            <th scope="col">ID</th>
            <th scope="col">Make</th>
            <th scope="col">Model</th>
            <th scope="col">Price</th>
            <th scope="col">Mileage</th>
            <th scope="col">Transmission</th>
            <th scope="col">Fuel</th>
            <th scope="col">Body</th>
            <th scope="col">Year</th>

            <!-- actions tab only shows if user is logged in  -->
            {% if current_user.is_authenticated and action_tab == True or current_user.is_admin %}
            <th scope="col">Actions</th>
            </thead>
            {% endif %}
        </tr>
       

    <!-- for loop which iterates through the car_list and populates the table each row corrresponds to a car from the car_list -->
    {% for car in car_list %}
    <tr>
        <tbody>
        <th scope="row" class="id-row">{{car.id}}</th>
        <td class="custom-row">{{car.make}}</td>  
        <td class="custom-row">{{car.model}}</td>  
        <td class="custom-row">{{ "Â£{:,}".format(car.price)}}</td>  
        <td class="custom-row">{{ "{:,}".format(car.mileage)}}</td> 
        <td class="custom-row">{{car.transmission.name}}</td> 
        <td class="custom-row">{{car.fuel.name}}</td> 
        <td class="custom-row">{{car.body.name}}</td>
        <td class="custom-row">{{car.year}}</td> 

        <!-- only display the edit and delete options if the user is logged in and listing belongs to them  -->
        <!-- ensures that the table is drawn correctly (lines for each listing) -->
        {% if current_user.is_authenticated and action_tab == True or current_user.is_admin %}
        <td class="action-row">
    <!-- if the current user is logged in and user id is the same as listings user id or the user is admin show the edit and delete actions on the table -->
            {% if current_user.is_authenticated and current_user.id == car.user_id or current_user.is_admin %}
            <div class="btn-group" role="group">
                <form method="GET" action="{{ url_for('edit_car', car_id=car.id)}}"><button type="submit" class="btn btn-secondary btn-sm" style="background-color: rgba(0, 128, 0, 0.786);">Edit</button></form>
                <form method="POST" action="{{ url_for('delete_car', car_id=car.id)}}"><button type="submit" class="btn btn-secondary btn-sm" style="background-color:rgba(227, 48, 48, 0.734);">Delete</button></form>
            </div>
            {% endif %}
        </td>
        {% endif %}
       </tbody>
    </tr>
   {% endfor %}

    </table>
</div>
{% endif %}
   

{% endblock %}

